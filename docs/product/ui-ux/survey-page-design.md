# 📋 問卷頁面設計

本文件詳細描述「餐廳會員管理系統」問卷填寫頁面的介面設計和使用者體驗。

---

## 🎯 設計目標

- **無障礙填寫**: 無需登入，使用 Token 認證
- **簡潔易懂**: 一頁顯示所有問題，避免複雜導航
- **即時驗證**: 提交前檢查必填題和格式
- **行動優先**: 響應式設計，手機體驗優化

---

## 📱 頁面佈局

### **桌面版（Desktop）**

```
┌────────────────────────────────────────────────────────┐
│                   [Logo / 品牌名稱]                    │
└────────────────────────────────────────────────────────┘
┌────────────────────────────────────────────────────────┐
│                                                        │
│             📋 用餐滿意度調查                          │
│                                                        │
│   感謝您的光臨！請撥冗填寫以下問卷，                    │
│   您的寶貴意見將幫助我們提供更好的服務。                │
│                                                        │
│   完成問卷即可獲得 1 點積分獎勵 🎁                     │
│                                                        │
│   ════════════════════════════════════════            │
│                                                        │
│   進度：已填 0 / 5 題                                  │
│                                                        │
│   ──────────────────────────────────────              │
│                                                        │
│   1. 您對今日的用餐體驗滿意嗎？ *                       │
│                                                        │
│      ☆  ☆  ☆  ☆  ☆                                   │
│     (點擊星星評分)                                      │
│                                                        │
│   ──────────────────────────────────────              │
│                                                        │
│   2. 您最喜歡哪道菜？                                  │
│                                                        │
│      [____________________________________]            │
│                                                        │
│   ──────────────────────────────────────              │
│                                                        │
│   3. 您會推薦給朋友嗎？ *                              │
│                                                        │
│      ○ 會                                             │
│      ○ 不會                                           │
│      ○ 不確定                                         │
│                                                        │
│   ──────────────────────────────────────              │
│                                                        │
│   4. 環境整潔度評分？ *                                │
│                                                        │
│      ★  ★  ★  ★  ☆  (4 / 5)                         │
│                                                        │
│   ──────────────────────────────────────              │
│                                                        │
│   5. 其他建議（可選）                                  │
│                                                        │
│      [____________________________________]            │
│      [____________________________________]            │
│      [____________________________________]            │
│                                                        │
│   ════════════════════════════════════════            │
│                                                        │
│                 [取消]    [提交問卷]                   │
│                                                        │
│   * 表示必填                                           │
│                                                        │
└────────────────────────────────────────────────────────┘
```

---

### **手機版（Mobile）**

```
┌─────────────────────────┐
│     [Logo]              │
├─────────────────────────┤
│                         │
│  📋 用餐滿意度調查       │
│                         │
│  感謝您的光臨！          │
│  請撥冗填寫以下問卷。    │
│                         │
│  完成即得 1 點積分 🎁   │
│                         │
│  ═══════════════════    │
│                         │
│  進度：0 / 5            │
│  ███░░░░░░  40%         │
│                         │
│  ───────────────────    │
│                         │
│  1. 您對今日的用餐      │
│     體驗滿意嗎？ *      │
│                         │
│     ☆ ☆ ☆ ☆ ☆          │
│                         │
│  ───────────────────    │
│                         │
│  2. 您最喜歡哪道菜？    │
│                         │
│     [______________]    │
│                         │
│  ───────────────────    │
│                         │
│  3. 您會推薦給朋友嗎？* │
│                         │
│     ○ 會                │
│     ○ 不會              │
│     ○ 不確定            │
│                         │
│  ───────────────────    │
│                         │
│  (繼續捲動查看更多問題) │
│                         │
│  ═══════════════════    │
│                         │
│  [取消]   [提交問卷]    │
│                         │
│  * 必填                 │
│                         │
└─────────────────────────┘
```

---

## 🎨 題型設計

### **1. 評分題（Rating）**

#### **桌面版**

```
您對今日的用餐體驗滿意嗎？ *

☆  ☆  ☆  ☆  ☆
```

**互動行為**:
- **滑鼠懸停**: 高亮當前星星和之前的星星
- **點擊**: 選中評分，星星變為實心 ★
- **可重選**: 點擊其他星星可更改評分

**樣式**:
- 未選中：`☆` 灰色 #d9d9d9
- 懸停：`★` 黃色 #faad14
- 選中：`★` 黃色 #faad14

#### **手機版**

```
您對今日的用餐體驗滿意嗎？ *

☆  ☆  ☆  ☆  ☆

已選：4 星
```

**互動行為**:
- **觸控**: 直接點擊星星評分
- **尺寸**: 星星圖示放大到 32x32px（觸控友善）
- **反饋**: 選中後顯示「已選：X 星」文字

---

### **2. 選擇題（Multiple Choice）**

#### **桌面版**

```
您會推薦給朋友嗎？ *

○ 會
○ 不會
○ 不確定
```

**互動行為**:
- **單選**: Radio 按鈕，只能選一個
- **點擊範圍**: 整個選項區域可點擊（不只圓圈）

**樣式**:
- 未選中：`○` 空心圓
- 選中：`●` 實心圓，藍色 #1890ff

#### **手機版**

```
您會推薦給朋友嗎？ *

┌───────────────────┐
│ ○ 會              │
├───────────────────┤
│ ○ 不會            │
├───────────────────┤
│ ○ 不確定          │
└───────────────────┘
```

**互動行為**:
- **卡片式設計**: 每個選項為獨立卡片
- **觸控區域**: 整個卡片可點擊
- **高度**: 最小 48px（符合觸控標準）

---

### **3. 文字題（Text）**

#### **單行文字**

```
您最喜歡哪道菜？

[________________________________________]
```

**互動行為**:
- **輸入框**: 單行文字輸入
- **最大長度**: 100 字元
- **驗證**: 即時顯示剩餘字數

#### **多行文字**

```
其他建議（可選）

[________________________________________]
[________________________________________]
[________________________________________]

0 / 500 字
```

**互動行為**:
- **文字區域**: 多行輸入框
- **最大長度**: 500 字元
- **自動擴展**: 內容超過 3 行時自動擴展高度
- **字數計數**: 即時顯示已輸入 / 最大字數

---

## 🔄 互動流程

### **載入頁面**

```
1. 用戶點擊問卷連結
   ↓
2. 驗證 Token
   ├─ 有效 → 載入問卷
   ├─ 無效 → 顯示「連結已失效」
   └─ 已填寫 → 顯示「您已填寫過此問卷」
```

### **填寫過程**

```
1. 用戶填寫問題
   ↓
2. 即時更新進度條
   (已填 3 / 5 題)
   ↓
3. 自動檢查必填題
   (提交按鈕根據狀態啟用/禁用)
```

### **提交問卷**

```
1. 用戶點擊「提交問卷」
   ↓
2. 驗證所有必填題
   ├─ 未完成 → 顯示錯誤提示
   │            捲動至第一個未填寫的必填題
   └─ 已完成 → 顯示確認對話框
   ↓
3. 確認提交
   ↓
4. 發送 API 請求
   ├─ 成功 → 顯示感謝頁面
   └─ 失敗 → 顯示錯誤訊息，允許重試
```

---

## ✅ 提交前驗證

### **驗證規則**

1. **必填題檢查**
   - 評分題：必須選擇星級
   - 選擇題：必須選擇一個選項
   - 文字題：不可為空

2. **格式驗證**
   - 文字長度：不超過最大限制
   - 特殊字元：允許所有 Unicode 字元

### **錯誤提示**

```
┌────────────────────────────────────┐
│ ⚠️  請完成所有必填題               │
├────────────────────────────────────┤
│                                    │
│ 以下問題尚未填寫：                  │
│                                    │
│ • 問題 1：您對今日的用餐體驗滿意嗎？│
│ • 問題 3：您會推薦給朋友嗎？        │
│                                    │
│           [確定]                   │
│                                    │
└────────────────────────────────────┘
```

**行為**:
- 彈出對話框顯示未完成的必填題
- 點擊「確定」後自動捲動至第一個未填寫的問題
- 未填寫的問題標題變紅色並加粗

---

## 🎉 提交成功頁面

```
┌────────────────────────────────────────────────────────┐
│                                                        │
│                       ✅                               │
│                                                        │
│                   感謝您的回饋！                       │
│                                                        │
│     您的寶貴意見已成功提交，將幫助我們提供更好的服務。 │
│                                                        │
│     ════════════════════════════════════════          │
│                                                        │
│                  🎁 積分獎勵                           │
│                                                        │
│              您已獲得 1 點問卷獎勵積分                 │
│                                                        │
│     (若您的發票已驗證，積分已自動入帳。               │
│      若尚未驗證，待驗證後將自動增加。)                 │
│                                                        │
│     ════════════════════════════════════════          │
│                                                        │
│                歡迎再次光臨！ 😊                       │
│                                                        │
│               [返回 LINE Bot]                          │
│                                                        │
└────────────────────────────────────────────────────────┘
```

---

## ❌ 錯誤狀態

### **Token 無效或過期**

```
┌────────────────────────────────────┐
│                                    │
│              ⚠️                    │
│                                    │
│       問卷連結已失效               │
│                                    │
│   此問卷連結已過期或無效。          │
│   請從 LINE Bot 取得最新的問卷連結。│
│                                    │
│        [返回 LINE Bot]             │
│                                    │
└────────────────────────────────────┘
```

### **已填寫過此問卷**

```
┌────────────────────────────────────┐
│                                    │
│              ℹ️                     │
│                                    │
│       您已填寫過此問卷             │
│                                    │
│   每筆交易的問卷只能填寫一次。      │
│   感謝您的支持！                    │
│                                    │
│        [返回 LINE Bot]             │
│                                    │
└────────────────────────────────────┘
```

### **系統錯誤**

```
┌────────────────────────────────────┐
│                                    │
│              ❌                    │
│                                    │
│       提交失敗                     │
│                                    │
│   很抱歉，系統暫時無法處理您的請求。│
│   請稍後再試。                      │
│                                    │
│   錯誤代碼：ERR-SURVEY-001         │
│                                    │
│  [重試]         [返回 LINE Bot]    │
│                                    │
└────────────────────────────────────┘
```

---

## 📊 進度指示器

### **桌面版**

```
進度：已填 3 / 5 題
```

**設計**:
- 簡單文字顯示
- 位置：頁面頂部，問卷標題下方
- 即時更新

### **手機版**

```
進度：3 / 5
███████░░░  60%
```

**設計**:
- 文字 + 進度條
- 進度條顏色：#1890ff（藍色）
- 即時更新，視覺反饋明確

---

## 🎨 視覺設計規範

### **色彩**

```
背景色: #f0f2f5 (淺灰)
卡片背景: #ffffff (白色)
主色: #1890ff (藍色)
成功: #52c41a (綠色)
警告: #faad14 (橘色)
錯誤: #ff4d4f (紅色)
文字: rgba(0, 0, 0, 0.85) (深灰)
```

### **間距**

```
頁面邊距: 24px (桌面), 16px (手機)
問題間距: 32px
元素間距: 16px
```

### **字體**

```
問卷標題: 24px, bold
問題文字: 16px, medium
選項文字: 14px, regular
輔助文字: 12px, regular
```

### **卡片樣式**

```
背景: #ffffff
圓角: 8px
陰影: 0 2px 8px rgba(0, 0, 0, 0.15)
邊框: none
```

---

## 📱 響應式設計

### **斷點**

- **Desktop**: ≥ 768px
  - 最大寬度：720px（置中顯示）
  - 問卷卡片寬度：100%

- **Mobile**: < 768px
  - 全寬顯示
  - 間距縮小
  - 星星圖示放大

### **觸控優化**

1. **按鈕尺寸**: 最小 44x44px
2. **觸控區域**: 整個選項區域可點擊
3. **間距**: 觸控目標間距 ≥ 8px
4. **反饋**: 觸控時顯示視覺反饋（高亮）

---

## ♿ 無障礙設計

### **語意化 HTML**

```html
<form role="form" aria-label="用餐滿意度調查">
  <fieldset>
    <legend>問題 1：您對今日的用餐體驗滿意嗎？</legend>
    <div role="radiogroup" aria-required="true">
      <!-- 評分星星 -->
    </div>
  </fieldset>
</form>
```

### **ARIA 屬性**

- `aria-required="true"`: 標示必填題
- `aria-label`: 提供螢幕閱讀器友善的標籤
- `aria-invalid`: 標示驗證失敗的欄位

### **鍵盤導航**

- **Tab**: 在問題間切換
- **Space/Enter**: 選擇選項
- **Arrow keys**: 在選擇題選項間移動

### **色彩對比**

- 所有文字與背景對比度 ≥ 4.5:1（WCAG AA 標準）
- 錯誤訊息使用圖示 + 顏色雙重提示

---

## 🔗 相關文件

- [US-004: 問卷系統](../stories/US-004-survey-system.md)
- [LINE Bot 對話流程](./linebot-conversation-flows.md)
- [管理後台設計](./admin-portal-design.md)
- [Ant Design Form](https://ant.design/components/form/)
- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)

---

**文件版本**: V3.1
**最後更新**: 2025-01-08
**維護者**: Product Team & UI/UX Designer
