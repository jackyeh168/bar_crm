# 🔍 稽核日誌系統介面設計

本文件詳細描述「餐廳會員管理系統」稽核日誌系統的所有頁面佈局、互動設計和使用者體驗。

---

## 📋 目錄

1. [稽核日誌列表頁](#稽核日誌列表頁)
2. [稽核日誌詳情頁](#稽核日誌詳情頁)
3. [合規報告匯出](#合規報告匯出)
4. [異常監控儀表板](#異常監控儀表板)
5. [GDPR 資料請求處理](#gdpr-資料請求處理)
6. [共用元件](#共用元件)

---

## 🎯 設計原則

### **1. 可追溯性 (Traceability)**
- 完整的變更歷史追蹤
- 時間軸視圖清晰呈現操作順序
- 關聯資料快速跳轉

### **2. 透明性 (Transparency)**
- 變更前後對比一目了然
- 操作原因清楚記錄
- 執行結果明確顯示

### **3. 合規性 (Compliance)**
- 支援 GDPR 資料請求
- 敏感資料自動遮罩
- 匯出格式符合監管要求

### **4. 效率性 (Efficiency)**
- 快速篩選與搜尋
- 常用查詢條件預設
- 批量匯出支援

---

## 稽核日誌列表頁

### **頁面佈局**

```
┌────────────────────────────────────────────────────────────────────────┐
│  🔍 稽核日誌查詢                                   [異常監控] [匯出]  │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│  篩選條件:                                                             │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │ 時間範圍: [最近 7 天 ▼]  操作類型: [全部 ▼]                      │ │
│  │                                                                  │ │
│  │ 操作者: [__________]  目標資源: [__________]  [搜尋] [重置]     │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  快速篩選:  [今天] [最近 7 天] [最近 30 天] [自訂範圍]                │
│                                                                        │
├──────┬──────────────┬─────────────┬───────────┬────────────┬─────────┤
│ 時間  │ 事件類型      │ 操作者       │ 目標資源   │ 動作       │ 操作   │
├──────┼──────────────┼─────────────┼───────────┼────────────┼─────────┤
│14:30 │ 💰 積分賺取   │ 👤 小陳      │ 積分帳戶   │ UPDATE     │ [詳情] │
│      │ POINTS_EARNED│ (M123)      │ PA789     │ ✅ 成功    │        │
├──────┼──────────────┼─────────────┼───────────┼────────────┼─────────┤
│14:25 │ 🔄 交易狀態   │ 👨‍💼 王姐    │ 交易       │ UPDATE     │ [詳情] │
│      │ TX_STATUS    │ (A456)      │ TX123     │ ✅ 成功    │        │
├──────┼──────────────┼─────────────┼───────────┼────────────┼─────────┤
│14:20 │ ✅ 會員註冊   │ 👤 小美      │ 會員       │ CREATE     │ [詳情] │
│      │ MEMBER_CREATED│(M456)      │ M456      │ ✅ 成功    │        │
├──────┼──────────────┼─────────────┼───────────┼────────────┼─────────┤
│14:15 │ ⚠️ 積分重算  │ 🤖 系統      │ 批次操作   │ UPDATE     │ [詳情] │
│      │ RECALCULATE  │ (SYSTEM)    │ Batch-001 │ ✅ 成功    │        │
│      │              │             │ 影響 1523  │            │        │
├──────┼──────────────┼─────────────┼───────────┼────────────┼─────────┤
│14:10 │ 🔑 管理員登入 │ 👨‍💼 王姐    │ 系統       │ LOGIN      │ [詳情] │
│      │ ADMIN_LOGIN  │ (A456)      │ Admin     │ ✅ 成功    │        │
│      │              │ IP: 192.*   │           │            │        │
└──────┴──────────────┴─────────────┴───────────┴────────────┴─────────┘

  顯示 1-10 筆，共 1,523 筆    [<上一頁]  第 1/153 頁  [下一頁>]
```

### **時間範圍選擇器**

**預設選項**:
```
時間範圍 ▼
├─ 今天 (2025-01-09)
├─ 最近 7 天
├─ 最近 30 天
├─ 最近 90 天
├─ 自訂範圍...
│  ┌────────────────────────┐
│  │ 開始: [2025-01-01]     │
│  │ 結束: [2025-01-09]     │
│  │          [確定] [取消] │
│  └────────────────────────┘
└─ 全部歷史記錄 (需 Admin 權限)
```

### **操作類型篩選器**

```
操作類型 ▼
├─ 全部
├─ 會員操作
│  ├─ ✅ 會員註冊 (MEMBER_CREATED)
│  ├─ 📝 資料變更 (MEMBER_UPDATED)
│  └─ ❌ 會員刪除 (MEMBER_DELETED)
├─ 積分操作
│  ├─ 💰 積分賺取 (POINTS_EARNED)
│  ├─ 💸 積分扣除 (POINTS_DEDUCTED)
│  └─ 🔄 積分重算 (POINTS_RECALCULATED)
├─ 交易操作
│  ├─ 📸 發票掃描 (TX_CREATED)
│  ├─ 🔄 狀態變更 (TX_STATUS_CHANGED)
│  └─ ✅ iChef 匹配 (TX_MATCHED)
├─ 問卷操作
│  ├─ 📋 問卷創建 (SURVEY_CREATED)
│  ├─ 🟢 問卷啟用 (SURVEY_ACTIVATED)
│  └─ 📝 問卷回應 (SURVEY_RESPONSE)
├─ 規則操作
│  ├─ ➕ 規則創建 (RULE_CREATED)
│  ├─ ✏️  規則修改 (RULE_UPDATED)
│  └─ ❌ 規則刪除 (RULE_DELETED)
└─ 管理員操作
   ├─ 🔑 登入 (ADMIN_LOGIN)
   ├─ 🚪 登出 (ADMIN_LOGOUT)
   ├─ 👤 角色變更 (ROLE_CHANGED)
   └─ ⚠️  敏感操作 (SENSITIVE_OP)
```

### **色彩編碼規則**

| 操作類型 | 圖示 | 顏色 | 說明 |
|---------|------|------|------|
| CREATE  | ➕   | #52c41a (綠色) | 新增資料 |
| UPDATE  | ✏️   | #1890ff (藍色) | 更新資料 |
| DELETE  | ❌   | #ff4d4f (紅色) | 刪除資料 |
| LOGIN   | 🔑   | #722ed1 (紫色) | 登入事件 |
| LOGOUT  | 🚪   | #8c8c8c (灰色) | 登出事件 |

### **操作者標示**

```
操作者類型圖示:
- 👤 MEMBER: 會員操作
- 👨‍💼 ADMIN: 管理員操作
- 🤖 SYSTEM: 系統自動操作
```

### **搜尋功能**

**支援搜尋欄位**:
- 操作者 ID 或名稱
- 目標資源 ID
- 描述文字（部分匹配）
- 變更內容（JSONB 搜尋）

**搜尋範例**:
```
搜尋範例:
- "M123" → 查詢會員 M123 的所有操作
- "積分" → 查詢所有包含「積分」的操作
- "王姐" → 查詢管理員王姐的操作
- "192.168.1.100" → 查詢特定 IP 的操作（已遮罩）
```

---

## 稽核日誌詳情頁

### **頁面佈局**

```
┌────────────────────────────────────────────────────────────────────────┐
│  ← 返回列表    稽核日誌詳情                                           │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│  基本資訊                                                              │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  稽核 ID: AUD-20250109-143045-ABC123                            │ │
│  │  時間: 2025-01-09 14:30:45.123                                  │ │
│  │  事件類型: 💰 積分賺取 (POINTS_EARNED)                           │ │
│  │  執行結果: ✅ 成功 (SUCCESS)                                     │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  操作者資訊                                                            │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  類型: 👤 會員 (MEMBER)                                          │ │
│  │  ID: M123                                                       │ │
│  │  名稱: 小陳                                                      │ │
│  │  IP 位址: 192.168.1.* (已遮罩)                                  │ │
│  │  User Agent: LINE/10.0.0                                        │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  目標資源                                                              │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  類型: 積分帳戶 (POINTS_ACCOUNT)                                 │ │
│  │  ID: PA789 → [查看帳戶]                                          │ │
│  │  描述: 積分帳戶 - 會員小陳                                       │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  變更內容 (Before → After)                                            │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  ┌────────────────┬────────────┬────────────┬──────────────┐    │ │
│  │  │ 欄位           │ 變更前     │ 變更後     │ 差異         │    │ │
│  │  ├────────────────┼────────────┼────────────┼──────────────┤    │ │
│  │  │ earned_points  │ 100        │ 103        │ +3 🟢       │    │ │
│  │  │ updated_at     │ 14:25:30   │ 14:30:45   │ +5分15秒    │    │ │
│  │  └────────────────┴────────────┴────────────┴──────────────┘    │ │
│  │                                                                  │ │
│  │  [展開 JSON 原始資料]                                            │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  元數據 (Metadata)                                                     │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  原因: 從交易獲得積分                                            │ │
│  │  相關交易 ID: TX456 → [查看交易]                                 │ │
│  │  問卷完成: ✅ 是                                                  │ │
│  │  批次 ID: -                                                      │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  相關操作 (時間軸)                                                     │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  14:35:00  💸 積分扣除 (POINTS_DEDUCTED) → [查看]                │ │
│  │      ↑                                                           │ │
│  │  14:30:45  💰 積分賺取 (POINTS_EARNED) ← 當前                    │ │
│  │      ↑                                                           │ │
│  │  14:25:30  🔄 交易狀態變更 (TX_STATUS_CHANGED) → [查看]         │ │
│  │      ↑                                                           │ │
│  │  14:20:00  📸 發票掃描 (TX_CREATED) → [查看]                     │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  [返回列表]                                                           │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

### **變更對比視覺化**

**正向變化**:
```
earned_points: 100 → 103 (+3) 🟢
使用綠色箭頭和加號，表示增加
```

**負向變化**:
```
earned_points: 103 → 100 (-3) 🔴
使用紅色箭頭和減號，表示減少
```

**狀態變化**:
```
status: imported → verified ✅
使用藍色箭頭，表示流程推進
```

### **JSON 原始資料展開**

```
[展開 JSON 原始資料] ← 點擊展開

展開後:
┌──────────────────────────────────────────┐
│ 變更前 (Before):                         │
│ {                                        │
│   "earned_points": 100,                  │
│   "used_points": 0,                      │
│   "available_points": 100,               │
│   "updated_at": "2025-01-09T14:25:30Z"   │
│ }                                        │
│                                          │
│ 變更後 (After):                          │
│ {                                        │
│   "earned_points": 103,                  │
│   "used_points": 0,                      │
│   "available_points": 103,               │
│   "updated_at": "2025-01-09T14:30:45Z"   │
│ }                                        │
│                                          │
│ [複製 JSON] [下載]                       │
└──────────────────────────────────────────┘
```

---

## 合規報告匯出

### **匯出對話框**

```
┌────────────────────────────────────────────────────────────┐
│  📊 匯出稽核報告                                   [X]     │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  報告類型:                                                 │
│  ○ 完整稽核日誌                                            │
│  ○ 會員操作歷史 (需指定會員 ID)                           │
│  ○ 管理員操作報告                                          │
│  ● GDPR 個人資料報告 (需指定會員 ID)                      │
│                                                            │
│  會員 ID:  [M123_______]  [驗證]                          │
│            ✅ 會員存在: 小陳 (0912****678)                 │
│                                                            │
│  時間範圍:                                                 │
│  開始日期: [2025-01-01]                                    │
│  結束日期: [2025-01-09]                                    │
│                                                            │
│  匯出格式:                                                 │
│  ● CSV (Excel 可開啟)                                      │
│  ○ PDF (正式報告)                                          │
│  ○ JSON (技術分析)                                         │
│                                                            │
│  包含資料:                                                 │
│  ☑ 基本資訊 (時間、事件類型、操作者)                       │
│  ☑ 變更內容 (Before/After)                                 │
│  ☑ 元數據 (原因、相關資源)                                 │
│  ☐ 系統自動操作 (不包含)                                   │
│                                                            │
│  敏感資料處理:                                             │
│  ● 自動遮罩 (手機號碼、IP 位址)                            │
│  ○ 完整顯示 (需 Admin 權限)                                │
│                                                            │
│  預估筆數: 約 127 筆                                        │
│  預估檔案大小: 約 45 KB                                     │
│                                                            │
│  ⚠️  注意事項:                                              │
│  • 單次最多匯出 10,000 筆記錄                               │
│  • 匯出操作將記錄在稽核日誌中                               │
│  • 敏感資料匯出需額外授權                                   │
│                                                            │
│                          [取消]  [匯出]                    │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

### **匯出進度**

```
匯出中...

┌────────────────────────────────────────┐
│  📊 正在匯出稽核報告                   │
│                                        │
│  [▓▓▓▓▓▓▓▓▓▓░░░░░░░░░░] 50%          │
│                                        │
│  已處理: 63 / 127 筆                   │
│  預估剩餘時間: 2 秒                    │
│                                        │
└────────────────────────────────────────┘
```

### **匯出完成**

```
┌────────────────────────────────────────┐
│  ✅ 匯出完成                            │
│                                        │
│  檔案名稱: audit_log_M123_20250109.csv │
│  檔案大小: 47 KB                       │
│  總筆數: 127 筆                        │
│                                        │
│  [下載檔案]  [關閉]                    │
│                                        │
└────────────────────────────────────────┘
```

### **CSV 格式範例**

```csv
稽核ID,時間,事件類型,操作者類型,操作者ID,操作者名稱,目標類型,目標ID,動作,變更前,變更後,原因,執行結果
AUD-20250109-143045-ABC123,2025-01-09 14:30:45,POINTS_EARNED,MEMBER,M123,小陳,POINTS_ACCOUNT,PA789,UPDATE,"earned_points: 100","earned_points: 103",從交易獲得積分,SUCCESS
AUD-20250109-142530-XYZ456,2025-01-09 14:25:30,TX_STATUS_CHANGED,ADMIN,A456,王姐,TRANSACTION,TX123,UPDATE,"status: imported","status: verified",iChef 批次驗證,SUCCESS
```

### **PDF 格式範例**

```
┌────────────────────────────────────────────────────────────┐
│                  稽核日誌報告                              │
│            餐廳會員管理系統                                │
│                                                            │
│  報告類型: GDPR 個人資料報告                               │
│  報告日期: 2025-01-09 15:00:00                             │
│  報告範圍: 2025-01-01 至 2025-01-09                        │
│  資料主體: 小陳 (M123, 0912****678)                        │
│                                                            │
│  ────────────────────────────────────────────────────      │
│                                                            │
│  1. 會員註冊                                               │
│     時間: 2025-01-05 10:23:15                              │
│     操作: 創建會員資料                                     │
│     資料: LINE ID, 手機號碼, 暱稱                          │
│                                                            │
│  2. 積分賺取                                               │
│     時間: 2025-01-09 14:30:45                              │
│     操作: 更新積分帳戶                                     │
│     變更: earned_points 100 → 103 (+3)                     │
│     原因: 從交易 TX456 獲得積分                            │
│                                                            │
│  ... (共 127 筆記錄)                                       │
│                                                            │
│  本報告符合 GDPR 第 15 條規定，提供個人資料處理活動的      │
│  完整記錄。資料主體有權要求更正或刪除不正確的資料。        │
│                                                            │
│  報告產生者: 王姐 (A456)                                   │
│  報告簽章: [數位簽章]                                      │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

---

## 異常監控儀表板

### **頁面佈局**

```
┌────────────────────────────────────────────────────────────────────────┐
│  ⚠️  異常監控儀表板                            [設定閾值] [通知設定]  │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│  實時異常告警 (最近 24 小時)                                           │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  🔴 嚴重 (2)   🟡 警告 (5)   🟢 正常                             │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  異常積分變動                                                          │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  🔴 14:35 - 會員 M789 單日積分變動 +1,250 點 (閾值: 1000)        │ │
│  │      原因: 批次重算錯誤？                         [查看] [忽略]  │ │
│  │                                                                  │ │
│  │  🟡 12:20 - 會員 M456 單日積分變動 +850 點 (接近閾值)            │ │
│  │      原因: 多筆交易驗證                           [查看] [忽略]  │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  異常登入行為                                                          │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  🟡 13:45 - IP 203.*.*.* 短時間內 3 次登入失敗                   │ │
│  │      帳號: admin@example.com                      [查看] [封鎖]  │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  批量操作監控                                                          │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  🟡 10:30 - 批次重算影響 1,523 筆記錄 (閾值: 100)                │ │
│  │      操作者: 王姐 (A456)                          [查看] [確認]  │ │
│  │                                                                  │ │
│  │  🟢 08:15 - iChef 批次匯入 87 筆 (正常)                          │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  歷史異常趨勢                                                          │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  [折線圖: 每日異常事件數量]                                      │ │
│  │                                                                  │ │
│  │   ▲                                                              │ │
│  │  8│        ●                                                     │ │
│  │  6│    ●       ●                                                 │ │
│  │  4│  ●   ●       ●   ●                                           │ │
│  │  2│●               ●   ●   ●                                     │ │
│  │  0└─────────────────────────────────────────────────→            │ │
│  │    1/3 1/4 1/5 1/6 1/7 1/8 1/9                                   │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

### **異常類型定義**

| 異常類型 | 閾值 | 嚴重程度 | 通知方式 |
|---------|------|---------|---------|
| 單日積分變動 | > 1000 點 | 🔴 嚴重 | 即時 Email + SMS |
| 短時間登入失敗 | 5 分鐘內 3 次 | 🟡 警告 | Email |
| 批量操作 | > 100 筆記錄 | 🟡 警告 | 系統通知 |
| 敏感操作 | 資料刪除 | 🔴 嚴重 | 即時 Email |
| 異常 IP 登入 | 新 IP 位址 | 🟢 資訊 | 系統通知 |

### **閾值設定對話框**

```
┌────────────────────────────────────────┐
│  ⚙️  異常監控閾值設定                   │
├────────────────────────────────────────┤
│                                        │
│  積分異常閾值:                         │
│  單日變動: [1000] 點                   │
│  單筆交易: [500] 點                    │
│                                        │
│  登入異常閾值:                         │
│  失敗次數: [3] 次                      │
│  時間窗口: [5] 分鐘                    │
│                                        │
│  批量操作閾值:                         │
│  影響筆數: [100] 筆                    │
│                                        │
│  通知設定:                             │
│  ☑ Email 通知                          │
│  ☑ 系統通知                            │
│  ☐ SMS 通知 (僅嚴重)                   │
│                                        │
│  通知收件人:                           │
│  admin@example.com                     │
│  [+ 新增收件人]                        │
│                                        │
│          [取消]  [儲存設定]            │
│                                        │
└────────────────────────────────────────┘
```

---

## GDPR 資料請求處理

### **資料刪除請求介面**

```
┌────────────────────────────────────────────────────────────────────────┐
│  🗑️  GDPR 資料刪除請求                                                 │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│  步驟 1: 驗證資料主體身份                                              │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  會員 ID: [M123_______]  [驗證]                                  │ │
│  │                                                                  │ │
│  │  ✅ 會員資料已找到:                                               │ │
│  │  • 暱稱: 小陳                                                     │ │
│  │  • 手機: 0912****678                                              │ │
│  │  • 註冊日期: 2025-01-05                                           │ │
│  │  • 累積積分: 103 點                                               │ │
│  │  • 交易筆數: 12 筆                                                │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  步驟 2: 刪除範圍選擇                                                  │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  ☑ 會員基本資料 (暱稱、手機號碼、LINE ID)                         │ │
│  │  ☑ 積分帳戶資料 (累積積分、交易記錄)                              │ │
│  │  ☑ 問卷回應資料 (所有問卷回應)                                    │ │
│  │  ☑ 發票掃描資料 (QR Code 資料、發票資訊)                          │ │
│  │  ☐ 稽核日誌 (保留，法規要求永久保存)                              │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  步驟 3: 刪除原因與批准                                                │
│  ┌──────────────────────────────────────────────────────────────────┐ │
│  │  刪除原因:                                                        │ │
│  │  ● GDPR 第 17 條 - 被遺忘權 (Right to be Forgotten)              │ │
│  │  ○ 會員主動要求                                                   │ │
│  │  ○ 資料不再需要                                                   │ │
│  │  ○ 其他: [________________]                                      │ │
│  │                                                                  │ │
│  │  請求 ID: [自動產生]                                              │ │
│  │  請求日期: 2025-01-09                                             │ │
│  │  執行者: 王姐 (A456)                                              │ │
│  │                                                                  │ │
│  │  ☑ 我已確認此為合法的資料刪除請求                                 │ │
│  │  ☑ 我了解此操作無法復原                                           │ │
│  │  ☑ 稽核日誌將永久保存此刪除操作記錄                               │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
│  ⚠️  警告:                                                              │
│  • 刪除操作無法復原                                                    │
│  • 刪除後會員無法再登入系統                                            │
│  • 積分將全部清除且無法恢復                                            │
│  • 此操作將完整記錄在稽核日誌中                                        │
│                                                                        │
│  安全驗證: 請輸入您的密碼 [__________]                                │
│                                                                        │
│                          [取消]  [確認刪除]                            │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

### **刪除確認對話框**

```
┌────────────────────────────────────────┐
│  ⚠️  最後確認                            │
├────────────────────────────────────────┤
│                                        │
│  您即將刪除以下資料:                   │
│                                        │
│  會員: 小陳 (M123)                     │
│  資料項目: 4 類                        │
│  影響記錄: 約 47 筆                    │
│                                        │
│  此操作無法復原！                      │
│                                        │
│  請輸入會員 ID 確認: [_____]           │
│                                        │
│          [取消]  [確認刪除]            │
│                                        │
└────────────────────────────────────────┘
```

### **刪除執行進度**

```
刪除中...

┌────────────────────────────────────────┐
│  🗑️  正在刪除會員資料                   │
│                                        │
│  ✅ 會員基本資料已刪除                  │
│  ✅ 積分帳戶資料已刪除                  │
│  ⏳ 正在刪除問卷回應...                 │
│  ⏸️  等待刪除發票資料...                │
│  ⏸️  等待記錄稽核日誌...                │
│                                        │
│  [▓▓▓▓▓▓▓▓░░░░░░░░░░░░] 40%          │
│                                        │
└────────────────────────────────────────┘
```

### **刪除完成確認**

```
┌────────────────────────────────────────┐
│  ✅ 資料刪除完成                        │
├────────────────────────────────────────┤
│                                        │
│  會員 M123 的資料已成功刪除。          │
│                                        │
│  刪除摘要:                             │
│  • 會員基本資料: 1 筆                  │
│  • 積分帳戶: 1 筆                      │
│  • 交易記錄: 12 筆                     │
│  • 問卷回應: 3 筆                      │
│  • 發票掃描: 31 筆                     │
│                                        │
│  稽核記錄:                             │
│  • 稽核 ID: AUD-20250109-150530-DEL001 │
│  • 請求 ID: GDPR-REQ-20250109-001      │
│  • 執行時間: 2025-01-09 15:05:30       │
│                                        │
│  [下載刪除證明 (PDF)]  [關閉]          │
│                                        │
└────────────────────────────────────────┘
```

---

## 共用元件

### **時間軸元件**

用於顯示相關操作的時間序列：

```
┌────────────────────────────────────────┐
│  相關操作時間軸                        │
├────────────────────────────────────────┤
│                                        │
│  15:00  💸 積分扣除                    │
│    ↑    -50 點（兌換折扣）             │
│    │                                   │
│  14:30  💰 積分賺取 ← 當前            │
│    ↑    +3 點（發票 + 問卷）           │
│    │                                   │
│  14:25  🔄 交易狀態變更                │
│    ↑    imported → verified            │
│    │                                   │
│  14:20  📸 發票掃描                    │
│         AB12345678                     │
│                                        │
│  [載入更多...]                         │
│                                        │
└────────────────────────────────────────┘
```

### **變更標籤 (Change Badge)**

用於快速識別變更類型：

```
數值增加: [+3 🟢]
數值減少: [-5 🔴]
狀態變更: [imported → verified ➡️]
新增資料: [NEW ⭐]
刪除資料: [DELETED ❌]
```

### **操作者頭像 (Actor Avatar)**

```
會員: 👤 + 藍色背景
管理員: 👨‍💼 + 紫色背景
系統: 🤖 + 灰色背景
```

### **敏感資料遮罩**

```
手機號碼: 0912****678 (顯示前 4 後 3)
IP 位址: 192.168.1.* (僅顯示前 3 段)
Email: ad***@example.com (部分遮罩)
```

---

## 🎨 色彩規範

### **事件類型色彩**

```css
--event-create: #52c41a;    /* 綠色 - 新增 */
--event-update: #1890ff;    /* 藍色 - 更新 */
--event-delete: #ff4d4f;    /* 紅色 - 刪除 */
--event-login: #722ed1;     /* 紫色 - 登入 */
--event-system: #8c8c8c;    /* 灰色 - 系統 */
```

### **異常等級色彩**

```css
--alert-critical: #ff4d4f;  /* 紅色 - 嚴重 */
--alert-warning: #faad14;   /* 橘色 - 警告 */
--alert-info: #1890ff;      /* 藍色 - 資訊 */
--alert-success: #52c41a;   /* 綠色 - 正常 */
```

---

## 📱 響應式設計

### **手機版佈局 (< 768px)**

稽核日誌列表簡化為卡片式：

```
┌──────────────────────────────────┐
│  🔍 稽核日誌                     │
├──────────────────────────────────┤
│  [時間範圍▼] [類型▼]            │
│                                  │
│  ┌────────────────────────────┐ │
│  │ 14:30  💰 積分賺取         │ │
│  │ 👤 小陳 (M123)             │ │
│  │ 積分帳戶: +3 點            │ │
│  │              [詳情]        │ │
│  └────────────────────────────┘ │
│                                  │
│  ┌────────────────────────────┐ │
│  │ 14:25  🔄 交易狀態變更     │ │
│  │ 👨‍💼 王姐 (A456)            │ │
│  │ TX123: imported→verified   │ │
│  │              [詳情]        │ │
│  └────────────────────────────┘ │
│                                  │
│  [載入更多...]                   │
│                                  │
└──────────────────────────────────┘
```

---

## 🔗 相關文件

- [US-007: 稽核日誌系統](../stories/US-007-audit-log-system.md) - User Story
- [PRD.md](../PRD.md) - 產品需求文件 (§ 2.7)
- [管理後台設計](./admin-portal-design.md) - 其他管理後台頁面
- [Ant Design Table](https://ant.design/components/table/) - 表格元件
- [Ant Design Timeline](https://ant.design/components/timeline/) - 時間軸元件

---

**文件版本**: V3.1
**最後更新**: 2025-01-09
**維護者**: Product Team & Design Team
